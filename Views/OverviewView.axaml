<UserControl
    x:Class="MealPrepHelper.Views.OverviewView"
    xmlns="https://github.com/avaloniaui"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:vm="using:MealPrepHelper.ViewModels"
    d:DesignHeight="800"
    d:DesignWidth="800"
    x:DataType="vm:OverviewViewModel"
    mc:Ignorable="d">

    <Grid>
        <Grid RowDefinitions="Auto, *, Auto">

            <StackPanel
                Grid.Row="0"
                Margin="20,20,20,10"
                Spacing="15">

                <Grid ColumnDefinitions="Auto, *, Auto">
                    <Button
                        Grid.Column="0"
                        Width="40"
                        Command="{Binding PrevWeekCommand}"
                        Content="&lt;" />

                    <Button
                        Grid.Column="1"
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center"
                        Background="Transparent"
                        BorderThickness="0"
                        Cursor="Hand">

                        <StackPanel Orientation="Horizontal" Spacing="5">
                            <TextBlock VerticalAlignment="Center" Text="ðŸ“…" />
                            <TextBlock
                                VerticalAlignment="Center"
                                FontSize="18"
                                FontWeight="Bold"
                                Foreground="Black"
                                Text="{Binding WeekRangeText}" />
                        </StackPanel>

                        <Button.Flyout>
                            <Flyout Placement="Bottom">
                                <Calendar
                                    DisplayDate="{Binding CurrentDate}"
                                    SelectedDate="{Binding CurrentDate, Mode=TwoWay}"
                                    SelectionMode="SingleDate" />
                            </Flyout>
                        </Button.Flyout>
                    </Button>

                    <Button
                        Grid.Column="2"
                        Width="40"
                        Command="{Binding NextWeekCommand}"
                        Content="&gt;" />
                </Grid>

                <ItemsControl ItemsSource="{Binding WeekDays}">
                    <ItemsControl.ItemsPanel>
                        <ItemsPanelTemplate>
                            <UniformGrid Columns="7" />
                        </ItemsPanelTemplate>
                    </ItemsControl.ItemsPanel>
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <Button
                                Margin="2"
                                HorizontalAlignment="Stretch"
                                Background="{Binding Background}"
                                Command="{Binding $parent[UserControl].((vm:OverviewViewModel)DataContext).SelectDayCommand}"
                                CommandParameter="{Binding}">
                                <StackPanel HorizontalAlignment="Center">
                                    <TextBlock
                                        HorizontalAlignment="Center"
                                        FontSize="10"
                                        Foreground="{Binding Foreground}"
                                        Text="{Binding DayName}" />
                                    <TextBlock
                                        HorizontalAlignment="Center"
                                        FontSize="16"
                                        FontWeight="{Binding FontWeight}"
                                        Foreground="{Binding Foreground}"
                                        Text="{Binding DayNumber}" />
                                </StackPanel>
                            </Button>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>

                <Separator Height="1" Background="#EEE" />
            </StackPanel>


            <ScrollViewer Grid.Row="1">
                <StackPanel Margin="20,0,20,20" Spacing="20">
                    <TextBlock
                        FontSize="20"
                        FontWeight="SemiBold"
                        Foreground="#555"
                        Text="PlÃ¡n jÃ­del" />

                    <ItemsControl ItemsSource="{Binding TodayMeals}">
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <Border
                                    Margin="0,0,0,10"
                                    Padding="15"
                                    Background="White"
                                    BoxShadow="0 2 5 0 #E0E0E0"
                                    CornerRadius="8">
                                    <Grid ColumnDefinitions="Auto, *, Auto">
                                        <StackPanel
                                            Grid.Column="0"
                                            Width="70"
                                            VerticalAlignment="Center">
                                            <TextBlock FontWeight="Bold" Text="{Binding ScheduledFor, StringFormat='HH:mm'}" />
                                            <TextBlock
                                                FontSize="12"
                                                Foreground="Gray"
                                                Text="{Binding MealType}" />
                                        </StackPanel>

                                        <StackPanel
                                            Grid.Column="1"
                                            Margin="10,0"
                                            VerticalAlignment="Center">
                                            <TextBlock FontWeight="SemiBold" Text="{Binding Recipe.Name}" />
                                            <TextBlock
                                                FontSize="12"
                                                Foreground="Gray"
                                                Text="{Binding Recipe.TotalCalories, StringFormat='{}{0} kcal'}" />
                                        </StackPanel>

                                        <StackPanel
                                            Grid.Column="2"
                                            VerticalAlignment="Center"
                                            Orientation="Horizontal"
                                            Spacing="10">
                                            <Button
                                                Background="Transparent"
                                                BorderThickness="0"
                                                Command="{Binding $parent[UserControl].((vm:OverviewViewModel)DataContext).OpenInfoCommand}"
                                                CommandParameter="{Binding}"
                                                Content="â„¹ï¸" />

                                            <CheckBox
                                                Command="{Binding $parent[UserControl].((vm:OverviewViewModel)DataContext).UpdateMealStatusCommand}"
                                                CommandParameter="{Binding}"
                                                IsChecked="{Binding IsEaten}" />
                                        </StackPanel>
                                    </Grid>
                                </Border>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>

                    <TextBlock
                        Margin="20"
                        HorizontalAlignment="Center"
                        Foreground="Gray"
                        IsVisible="{Binding !TodayMeals.Count}"
                        Text="Pro tento den nenÃ­ nic naplÃ¡novÃ¡no." />
                </StackPanel>
            </ScrollViewer>


            <Border
                Grid.Row="2"
                Padding="20"
                Background="White"
                BorderBrush="#E0E0E0"
                BorderThickness="0,1,0,0">
                <UniformGrid HorizontalAlignment="Stretch" Columns="5">

                    <StackPanel HorizontalAlignment="Center" Spacing="5">
                        <Grid Width="60" Height="60">
                            <Arc
                                StartAngle="0"
                                Stretch="None"
                                Stroke="#EEE"
                                StrokeThickness="6"
                                SweepAngle="360" />
                            <Arc
                                StartAngle="-90"
                                Stretch="None"
                                Stroke="{Binding ColorCalories}"
                                StrokeLineCap="Round"
                                StrokeThickness="6"
                                SweepAngle="{Binding AngleCalories}" />
                            <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                                <TextBlock
                                    HorizontalAlignment="Center"
                                    FontSize="12"
                                    FontWeight="Bold"
                                    Text="{Binding CurrentCalories}" />
                                <TextBlock
                                    HorizontalAlignment="Center"
                                    FontSize="8"
                                    Foreground="Gray"
                                    Text="kcal" />
                            </StackPanel>
                        </Grid>
                        <TextBlock
                            HorizontalAlignment="Center"
                            FontSize="11"
                            FontWeight="SemiBold"
                            Text="Kalorie" />

                        <TextBlock
                            Margin="0,-3,0,0"
                            HorizontalAlignment="Center"
                            FontSize="10"
                            Foreground="#999"
                            Text="{Binding GoalCalories, StringFormat='CÃ­l: {0} kcal'}" />
                    </StackPanel>

                    <StackPanel HorizontalAlignment="Center" Spacing="5">
                        <Grid Width="60" Height="60">
                            <Arc
                                StartAngle="0"
                                Stretch="None"
                                Stroke="#EEE"
                                StrokeThickness="6"
                                SweepAngle="360" />
                            <Arc
                                StartAngle="-90"
                                Stretch="None"
                                Stroke="{Binding ColorProtein}"
                                StrokeLineCap="Round"
                                StrokeThickness="6"
                                SweepAngle="{Binding AngleProtein}" />
                            <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                                <TextBlock
                                    HorizontalAlignment="Center"
                                    FontSize="12"
                                    FontWeight="Bold"
                                    Text="{Binding CurrentProtein, StringFormat='{}{0:0}'}" />
                                <TextBlock
                                    HorizontalAlignment="Center"
                                    FontSize="8"
                                    Foreground="Gray"
                                    Text="g" />
                            </StackPanel>
                        </Grid>
                        <TextBlock
                            HorizontalAlignment="Center"
                            FontSize="11"
                            FontWeight="SemiBold"
                            Text="BÃ­lkoviny" />

                        <TextBlock
                            Margin="0,-3,0,0"
                            HorizontalAlignment="Center"
                            FontSize="10"
                            Foreground="#999"
                            Text="{Binding GoalProtein, StringFormat='CÃ­l: {0} g'}" />
                    </StackPanel>

                    <StackPanel HorizontalAlignment="Center" Spacing="5">
                        <Grid Width="60" Height="60">
                            <Arc
                                StartAngle="0"
                                Stretch="None"
                                Stroke="#EEE"
                                StrokeThickness="6"
                                SweepAngle="360" />
                            <Arc
                                StartAngle="-90"
                                Stretch="None"
                                Stroke="{Binding ColorCarbs}"
                                StrokeLineCap="Round"
                                StrokeThickness="6"
                                SweepAngle="{Binding AngleCarbs}" />
                            <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                                <TextBlock
                                    HorizontalAlignment="Center"
                                    FontSize="12"
                                    FontWeight="Bold"
                                    Text="{Binding CurrentCarbs, StringFormat='{}{0:0}'}" />
                                <TextBlock
                                    HorizontalAlignment="Center"
                                    FontSize="8"
                                    Foreground="Gray"
                                    Text="g" />
                            </StackPanel>
                        </Grid>
                        <TextBlock
                            HorizontalAlignment="Center"
                            FontSize="11"
                            FontWeight="SemiBold"
                            Text="Sacharidy" />

                        <TextBlock
                            Margin="0,-3,0,0"
                            HorizontalAlignment="Center"
                            FontSize="10"
                            Foreground="#999"
                            Text="{Binding GoalCarbs, StringFormat='CÃ­l: {0} g'}" />
                    </StackPanel>

                    <StackPanel HorizontalAlignment="Center" Spacing="5">
                        <Grid Width="60" Height="60">
                            <Arc
                                StartAngle="0"
                                Stretch="None"
                                Stroke="#EEE"
                                StrokeThickness="6"
                                SweepAngle="360" />
                            <Arc
                                StartAngle="-90"
                                Stretch="None"
                                Stroke="{Binding ColorFat}"
                                StrokeLineCap="Round"
                                StrokeThickness="6"
                                SweepAngle="{Binding AngleFat}" />
                            <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                                <TextBlock
                                    HorizontalAlignment="Center"
                                    FontSize="12"
                                    FontWeight="Bold"
                                    Text="{Binding CurrentFat, StringFormat='{}{0:0}'}" />
                                <TextBlock
                                    HorizontalAlignment="Center"
                                    FontSize="8"
                                    Foreground="Gray"
                                    Text="g" />
                            </StackPanel>
                        </Grid>
                        <TextBlock
                            HorizontalAlignment="Center"
                            FontSize="11"
                            FontWeight="SemiBold"
                            Text="Tuky" />

                        <TextBlock
                            Margin="0,-3,0,0"
                            HorizontalAlignment="Center"
                            FontSize="10"
                            Foreground="#999"
                            Text="{Binding GoalFat, StringFormat='CÃ­l: {0} g'}" />
                    </StackPanel>

                    <StackPanel HorizontalAlignment="Center" Spacing="5">
                        <Grid Width="60" Height="60">
                            <Arc
                                StartAngle="0"
                                Stretch="None"
                                Stroke="#EEE"
                                StrokeThickness="6"
                                SweepAngle="360" />
                            <Arc
                                StartAngle="-90"
                                Stretch="None"
                                Stroke="{Binding ColorFiber}"
                                StrokeLineCap="Round"
                                StrokeThickness="6"
                                SweepAngle="{Binding AngleFiber}" />
                            <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                                <TextBlock
                                    HorizontalAlignment="Center"
                                    FontSize="12"
                                    FontWeight="Bold"
                                    Text="{Binding CurrentFiber, StringFormat='{}{0:0}'}" />
                                <TextBlock
                                    HorizontalAlignment="Center"
                                    FontSize="8"
                                    Foreground="Gray"
                                    Text="g" />
                            </StackPanel>
                        </Grid>
                        <TextBlock
                            HorizontalAlignment="Center"
                            FontSize="11"
                            FontWeight="SemiBold"
                            Text="VlÃ¡knina" />

                        <TextBlock
                            Margin="0,-3,0,0"
                            HorizontalAlignment="Center"
                            FontSize="10"
                            Foreground="#999"
                            Text="{Binding GoalFiber, StringFormat='CÃ­l: {0} g'}" />
                    </StackPanel>

                </UniformGrid>
            </Border>
        </Grid>

        <Popup
            IsOpen="{Binding IsInfoVisible}"
            Placement="Center"
            PlacementTarget="{Binding $parent[Window]}"
            Topmost="True"
            WindowManagerAddShadowHint="False">

            <Grid
                Width="{Binding $parent[Window].Bounds.Width}"
                Height="{Binding $parent[Window].Bounds.Height}"
                Background="#AA000000">

                <Button
                    HorizontalAlignment="Stretch"
                    VerticalAlignment="Stretch"
                    Background="Transparent"
                    BorderThickness="0"
                    Command="{Binding CloseInfoCommand}" />

                <Border
                    Width="500"
                    Height="650"
                    HorizontalAlignment="Center"
                    VerticalAlignment="Center"
                    Background="White"
                    BoxShadow="0 4 20 0 #40000000"
                    CornerRadius="12">

                    <Grid RowDefinitions="Auto, *, Auto">
                        <Grid
                            Grid.Row="0"
                            Margin="20"
                            ColumnDefinitions="*, Auto">
                            <StackPanel>
                                <TextBlock
                                    FontSize="22"
                                    FontWeight="Bold"
                                    Text="{Binding SelectedPlanItem.Recipe.Name}"
                                    TextWrapping="Wrap" />
                                <StackPanel
                                    Margin="0,5,0,0"
                                    Orientation="Horizontal"
                                    Spacing="10">
                                    <TextBlock
                                        FontWeight="SemiBold"
                                        Foreground="#2196F3"
                                        Text="{Binding SelectedPlanItem.MealType}" />
                                    <TextBlock Foreground="Gray" Text="â€¢" />
                                    <TextBlock Foreground="Gray" Text="{Binding SelectedPlanItem.ScheduledFor, StringFormat='HH:mm'}" />
                                    <TextBlock Foreground="Gray" Text="â€¢" />
                                    <TextBlock Foreground="#FF5722" Text="{Binding SelectedPlanItem.Recipe.TotalCalories, StringFormat='{}{0} kcal'}" />
                                </StackPanel>
                            </StackPanel>

                            <Button
                                Grid.Column="1"
                                VerticalAlignment="Top"
                                Background="Transparent"
                                Command="{Binding CloseInfoCommand}"
                                Content="âœ•"
                                FontSize="18"
                                Foreground="Gray" />
                        </Grid>

                        <ScrollViewer Grid.Row="1" Padding="20,0,20,20">
                            <StackPanel Spacing="15">
                                <Border
                                    Padding="15"
                                    Background="#FAFAFA"
                                    CornerRadius="8">
                                    <StackPanel>
                                        <TextBlock
                                            Margin="0,0,0,10"
                                            FontWeight="Bold"
                                            Text="ðŸ›’ Ingredience" />
                                        <ItemsControl ItemsSource="{Binding RecipeIngredientsCheck}">
                                            <ItemsControl.ItemTemplate>
                                                <DataTemplate>
                                                    <Border
                                                        Padding="0,5"
                                                        BorderBrush="#F0F0F0"
                                                        BorderThickness="0,0,0,1">
                                                        <Grid ColumnDefinitions="Auto, *, Auto, Auto">

                                                            <StackPanel
                                                                Grid.Column="0"
                                                                VerticalAlignment="Center"
                                                                Orientation="Horizontal"
                                                                Spacing="5">
                                                                <TextBlock
                                                                    Margin="0,0,5,0"
                                                                    VerticalAlignment="Center"
                                                                    Text="{Binding StatusIcon}" />
                                                                <TextBlock
                                                                    FontWeight="Bold"
                                                                    Foreground="#333"
                                                                    Text="{Binding AmountNeeded}" />
                                                                <TextBlock Foreground="Gray" Text="{Binding Unit}" />
                                                                <TextBlock
                                                                    Margin="5,0,0,0"
                                                                    Text="{Binding Name}"
                                                                    TextWrapping="Wrap" />
                                                            </StackPanel>

                                                            <TextBlock
                                                                Grid.Column="2"
                                                                Margin="0,0,10,0"
                                                                HorizontalAlignment="Right"
                                                                VerticalAlignment="Center"
                                                                FontSize="11"
                                                                Foreground="{Binding StatusColor}"
                                                                Text="{Binding StatusText}" />

                                                            <Button
                                                                Grid.Column="3"
                                                                Padding="8,4"
                                                                Background="#E3F2FD"
                                                                BorderThickness="0"
                                                                Command="{Binding AddToCartCommand}"
                                                                Content="{Binding CartIcon}"
                                                                CornerRadius="4"
                                                                FontSize="12"
                                                                Foreground="#2196F3"
                                                                IsEnabled="{Binding CanAdd}"
                                                                ToolTip.Tip="PÅ™idat chybÄ›jÃ­cÃ­ mnoÅ¾stvÃ­ na nÃ¡kupnÃ­ seznam" />
                                                        </Grid>
                                                    </Border>
                                                </DataTemplate>
                                            </ItemsControl.ItemTemplate>
                                        </ItemsControl>
                                    </StackPanel>
                                </Border>

                                <StackPanel>
                                    <TextBlock
                                        Margin="0,10"
                                        FontWeight="Bold"
                                        Text="ðŸ‘¨â€ðŸ³ Postup pÅ™Ã­pravy" />
                                    <TextBlock
                                        LineHeight="22"
                                        Text="{Binding SelectedPlanItem.Recipe.Instructions}"
                                        TextWrapping="Wrap" />
                                </StackPanel>
                            </StackPanel>
                        </ScrollViewer>

                        <Border
                            Grid.Row="2"
                            Padding="20"
                            BorderBrush="#EEE"
                            BorderThickness="0,1,0,0">
                            <Button
                                Height="40"
                                HorizontalAlignment="Stretch"
                                HorizontalContentAlignment="Center"
                                VerticalContentAlignment="Center"
                                Background="#FFEBEE"
                                BorderThickness="0"
                                Command="{Binding DeleteItemCommand}"
                                CommandParameter="{Binding SelectedPlanItem}"
                                Content="Smazat jÃ­dlo"
                                Foreground="#D32F2F" />
                        </Border>
                    </Grid>
                </Border>
            </Grid>
        </Popup>

    </Grid>
</UserControl>
